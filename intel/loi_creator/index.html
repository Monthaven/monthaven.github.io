<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>LOI PDF Creator | Monthaven Capital</title>
  <meta name="description" content="Generate institutional-grade letters of intent with branded formatting, numbered key terms, and print-ready output." />
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&family=Lora:wght@500;600&display=swap" rel="stylesheet" />
  <link rel="stylesheet" href="/theme.css" />
  <link rel="stylesheet" href="/styles.css" />
  <link rel="icon" type="image/svg+xml" href="/assets/favicon.svg" />
  <link rel="canonical" href="https://monthavencapital.com/intel/loi_creator" />
  <meta property="og:type" content="website" />
  <meta property="og:site_name" content="Monthaven Capital Inc." />
  <meta property="og:title" content="LOI PDF Creator | Monthaven Capital" />
  <meta property="og:description" content="Build an institutional LOI with customizable defaults, smart numbering, and a branded PDF layout." />
  <meta property="og:url" content="https://monthavencapital.com/intel/loi_creator" />
  <meta property="og:image" content="https://monthavencapital.com/assets/social-card.png" />
  <meta property="og:image:alt" content="Monthaven Capital brand mark on gradient background" />
  <meta name="twitter:card" content="summary_large_image" />
  <meta name="twitter:title" content="LOI PDF Creator | Monthaven Capital" />
  <meta name="twitter:description" content="Build an institutional LOI with customizable defaults, smart numbering, and a branded PDF layout." />
  <meta name="twitter:image" content="https://monthavencapital.com/assets/social-card.png" />
  <meta name="twitter:image:alt" content="Monthaven Capital brand mark on gradient background" />
  <link rel="manifest" href="/site.webmanifest" />
  <meta name="theme-color" content="#111827" />
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-CFGZGFMX9G"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'G-CFGZGFMX9G');
  </script>
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@graph": [
      {
        "@type": "Organization",
        "@id": "https://monthavencapital.com/#organization",
        "name": "Monthaven Capital Inc.",
        "url": "https://monthavencapital.com/",
        "logo": {
          "@type": "ImageObject",
          "url": "https://monthavencapital.com/assets/logo.svg"
        },
        "sameAs": [
          "https://www.linkedin.com/company/monthaven-capital/"
        ],
        "contactPoint": [
          {
            "@type": "ContactPoint",
            "email": "info@monthavencapital.com",
            "contactType": "Business"
          }
        ]
      },
      {
        "@type": "WebSite",
        "@id": "https://monthavencapital.com/#website",
        "url": "https://monthavencapital.com/",
        "name": "Monthaven Capital",
        "publisher": {
          "@id": "https://monthavencapital.com/#organization"
        }
      },
      {
        "@type": "BreadcrumbList",
        "@id": "https://monthavencapital.com/intel/loi_creator#breadcrumb",
        "itemListElement": [
          {
            "@type": "ListItem",
            "position": 1,
            "name": "Home",
            "item": "https://monthavencapital.com/"
          },
          {
            "@type": "ListItem",
            "position": 2,
            "name": "Intel",
            "item": "https://monthavencapital.com/intel"
          },
          {
            "@type": "ListItem",
            "position": 3,
            "name": "LOI PDF Creator",
            "item": "https://monthavencapital.com/intel/loi_creator"
          }
        ]
      },
      {
        "@type": [
          "WebPage",
          "CollectionPage"
        ],
        "@id": "https://monthavencapital.com/intel/loi_creator#webpage",
        "url": "https://monthavencapital.com/intel/loi_creator",
        "name": "LOI PDF Creator | Monthaven Capital",
        "description": "Generate institutional-grade letters of intent with branded formatting, numbered key terms, and print-ready output.",
        "isPartOf": {
          "@id": "https://monthavencapital.com/#website"
        }
      }
    ]
  }
  </script>
</head>
<body class="loi-page">
  <header class="site-header">
    <div class="container">
      <div class="brand-group">
        <a href="/" aria-label="Monthaven Capital Inc.">
          <img class="brand-mark" src="/assets/logo.svg" alt="Monthaven Capital logo">
          <div class="brand-text">
            <span class="brand-line-1">Monthaven</span>
            <span class="brand-line-2">Capital</span>
          </div>
        </a>
      </div>
      <button class="mobile-nav-toggle" type="button" aria-expanded="false" aria-controls="primary-navigation">Menu</button>
      <nav id="primary-navigation" class="nav" aria-label="Primary navigation">
        <a href="/">Home</a>
        <a href="/contact">Contact</a>
        <a class="btn btn-primary" href="/text">Text Updates</a>
      </nav>
        <a href="/how">How We Work</a>
        <a href="/intel" aria-current="page">Intel</a>
        <a href="/team">Team</a>
        <a class="btn btn-outline" href="/submit-a-deal/">Submit a Deal</a>
        <a class="btn btn-primary" href="/contact">Request Access</a>
      </nav>
    </div>
  </header>

  <main>
    <nav class="breadcrumb" aria-label="Breadcrumb">
      <div class="container">
        <ol>
          <li><a href="/">Home</a></li>
          <li><a href="/intel">Intel</a></li>
          <li aria-current="page">LOI PDF Creator</li>
        </ol>
      </div>
    </nav>

    <section class="page-hero">
      <div class="container">
        <p class="eyebrow">Tools</p>
        <p class="hero-tagline">Deal execution resources</p>
        <h1>Institutional Letter of Intent (LOI) Generator</h1>
        <p>Create a polished, print-ready LOI with configurable defaults, automated numbering, and space for signatures.</p>
      </div>
    </section>

    <section class="section loi-section">
      <div class="container">
        <div class="loi-layout" id="loiLayout">
          <section id="formWrapper" class="loi-panel print-hidden">
            <div class="loi-panel-header">
              <h2>Inputs</h2>
              <div class="loi-toolbar">
                <label class="loi-checkbox-label" for="toggleWatermark">
                  <input type="checkbox" id="toggleWatermark" class="loi-checkbox" />
                  Show DRAFT watermark
                </label>
                <button id="prefillBtn" type="button" class="btn btn-outline btn-compact">Use institutional defaults</button>
              </div>
            </div>

            <form id="loiForm" class="loi-form">
              <fieldset class="loi-fieldset">
                <legend>Your Information (Sender)</legend>
                <div class="loi-grid two">
                  <div class="loi-field">
                    <label for="senderName">Full Name</label>
                    <input id="senderName" type="text" class="loi-input" value="Jane Doe" />
                  </div>
                  <div class="loi-field">
                    <label for="senderTitle">Title</label>
                    <input id="senderTitle" type="text" class="loi-input" value="Managing Partner" />
                  </div>
                </div>
                <div class="loi-grid two">
                  <div class="loi-field">
                    <label for="senderCompany">Company</label>
                    <input id="senderCompany" type="text" class="loi-input" value="Your Company, LLC" />
                  </div>
                  <div class="loi-field">
                    <label for="senderEmail">Email</label>
                    <input id="senderEmail" type="email" class="loi-input" value="jane.doe@yourco.com" />
                  </div>
                </div>
                <div class="loi-field">
                  <label for="senderAddress">Company Address</label>
                  <input id="senderAddress" type="text" class="loi-input" value="123 Main St, Anytown, ST 12345" />
                </div>
                <div class="loi-field">
                  <label for="logoUpload">Company Logo (optional)</label>
                  <input id="logoUpload" type="file" accept="image/*" class="loi-file" />
                </div>
              </fieldset>

              <fieldset class="loi-fieldset">
                <legend>Recipient</legend>
                <div class="loi-grid two">
                  <div class="loi-field">
                    <label for="recipientName">Full Name</label>
                    <input id="recipientName" type="text" class="loi-input" value="John Smith" />
                  </div>
                  <div class="loi-field">
                    <label for="recipientTitle">Title</label>
                    <input id="recipientTitle" type="text" class="loi-input" value="President" />
                  </div>
                </div>
                <div class="loi-grid two">
                  <div class="loi-field">
                    <label for="recipientCompany">Company</label>
                    <input id="recipientCompany" type="text" class="loi-input" value="Recipient Corp." />
                  </div>
                  <div class="loi-field">
                    <label for="recipientAddress">Company Address</label>
                    <input id="recipientAddress" type="text" class="loi-input" value="456 Business Ave, Otherville, ST 67890" />
                  </div>
                </div>
              </fieldset>

              <fieldset class="loi-fieldset">
                <legend>Letter Details</legend>
                <div class="loi-grid two">
                  <div class="loi-field">
                    <label for="letterDate">Date</label>
                    <input id="letterDate" type="date" class="loi-input" />
                  </div>
                  <div class="loi-field">
                    <label for="expiryDate">LOI Expiration</label>
                    <input id="expiryDate" type="date" class="loi-input" />
                  </div>
                </div>
                <div class="loi-field">
                  <label for="subject">Subject</label>
                  <input id="subject" type="text" class="loi-input" value="Non-Binding Letter of Intent for the Acquisition of Assets" />
                </div>
              </fieldset>

              <fieldset class="loi-fieldset">
                <legend>Body</legend>
                <div class="loi-field">
                  <label for="introParagraph">Introduction</label>
                  <textarea id="introParagraph" rows="4" class="loi-textarea">This Letter of Intent (the "Letter") outlines the proposed terms and conditions for a transaction in which Your Company, LLC or its affiliate ("Buyer") would acquire substantially all of the assets of Recipient Corp. ("Seller").</textarea>
                </div>
                <div class="loi-field">
                  <div class="loi-label-row">
                    <label for="keyTerms">Key Terms (numbered list supported)</label>
                    <span class="loi-hint">Start lines with 1., 2., 3. to auto-number.</span>
                  </div>
                  <textarea id="keyTerms" rows="10" class="loi-textarea">1. The Proposed Transaction: Buyer proposes to acquire substantially all of the assets used in the operation of the Seller's business (the "Assets"). Included Assets: The Assets shall include, but not be limited to, all intellectual property, customer and supplier lists, contracts, inventory, equipment, and goodwill. Excluded Assets: The Seller will retain certain assets, such as cash, cash equivalents, and accounts receivable existing at Closing (unless otherwise agreed). Excluded Liabilities: The Buyer will not assume any of the Seller's liabilities or obligations, past or present, except for those expressly identified and agreed upon in the Definitive Agreement. The transaction will be on a "cash-free, debt-free" basis.
2. Purchase Price: The proposed purchase price is $5,000,000 USD. Payment: The Purchase Price will be payable in cash at the closing of the transaction (the "Closing"). Working Capital Adjustment: The Purchase Price will be subject to a standard post-Closing adjustment to ensure a normalized level of net working capital is delivered to the Buyer. The specific target and calculation method will be detailed in the Definitive Agreement.
3. Key Conditions: The Closing of the Proposed Transaction will be contingent upon several conditions, including: (i) the successful completion of Buyer's due diligence to its sole satisfaction; (ii) the negotiation and execution of a definitive Asset Purchase Agreement (the "Definitive Agreement"); (iii) receipt of any necessary board, shareholder, and third-party consents; (iv) the absence of any material adverse change in the Seller's business or financial condition; and (v) the retention of certain key employees identified by the Buyer.
4. Due Diligence: Upon execution of this Letter, Seller shall provide Buyer and its representatives with reasonable access to its business, financial, legal, and operational records and facilities for a period of 30 days (the "Diligence Period").
5. Definitive Agreement: The parties will negotiate in good faith to draft a Definitive Agreement that will contain standard representations, warranties, covenants, and indemnification provisions customary for a transaction of this nature.
6. Binding Provisions: This Letter is an expression of intent and is non-binding, creating no legal obligations on either party, except for the following provisions, which shall be legally binding and survive the termination of this Letter: Confidentiality: Both parties agree to keep the existence and content of these negotiations, as well as all information shared during due diligence, strictly confidential. A separate Non-Disclosure Agreement may be executed. Exclusivity (No-Shop): From the date of execution until the expiration of this Letter, Seller agrees not to, directly or indirectly, solicit, initiate, or engage in discussions with any other party regarding the sale of its business or assets. Expenses: Each party will be responsible for its own costs and expenses incurred in connection with the Proposed Transaction, including legal, accounting, and advisory fees. Governing Law: This Letter and the binding provisions shall be governed by the laws of the State of [Insert State].
7. Expiration: This offer shall expire at 5:00 p.m. Eastern Time on November 3, 2025, unless accepted by the Seller in writing, or otherwise extended by the Buyer in writing.</textarea>
                </div>
                <div class="loi-field">
                  <label for="bindingClause">Binding / Non-Binding Clause</label>
                  <textarea id="bindingClause" rows="4" class="loi-textarea">This Letter is intended solely as a non-binding expression of mutual intent. Except for the provisions titled Confidentiality, Exclusivity (No-Shop), Expenses, and Governing Law (collectively, the "Binding Provisions"), neither party shall be under any legal obligation with respect to the Proposed Transaction unless and until a Definitive Agreement is executed.</textarea>
                </div>
                <div class="loi-field">
                  <label for="closingParagraph">Closing / Next Steps</label>
                  <textarea id="closingParagraph" rows="4" class="loi-textarea">We are enthusiastic about the potential of this transaction and look forward to working with you toward a successful closing.

Please signify your agreement with the Binding Provisions and the process outlined above by signing and returning a countersigned copy of this Letter.</textarea>
                </div>
              </fieldset>

              <div class="loi-actions">
                <button type="submit" class="btn btn-primary">Generate LOI</button>
                <button id="copyBtn" type="button" class="btn btn-outline btn-compact">Copy body text</button>
                <button id="resetButton" type="button" class="btn btn-outline btn-compact">Reset</button>
              </div>
            </form>
          </section>

          <section id="previewWrapper" class="loi-preview">
            <div class="loi-preview-actions print-hidden">
              <button id="printButton" type="button" class="btn btn-primary btn-compact">Print / Save PDF</button>
              <button id="backToForm" type="button" class="btn btn-outline btn-compact">Edit inputs</button>
            </div>
            <div class="loi-document-wrapper" id="docWrapper">
              <div class="print-header">
                <div class="print-header-inner">
                  <div id="printHeaderLeft"></div>
                  <div id="printHeaderRight"></div>
                </div>
              </div>
              <div class="print-footer">
                <div class="print-footer-inner">
                  <div>Confidential</div>
                  <div>Page <span class="pageNumber">1</span></div>
                </div>
              </div>

              <article id="loiOutput" class="loi-document print-body">
                <header>
                  <div class="loi-sender">
                    <div id="outputSenderCompany" class="loi-sender-company"></div>
                    <div id="outputSenderAddress" class="loi-sender-address"></div>
                    <div id="outputSenderEmail" class="loi-sender-email"></div>
                  </div>
                  <img id="logoPreview" src="#" alt="Company logo" class="loi-logo hidden" />
                </header>

                <div class="loi-recipient-block">
                  <div id="outputDate" class="loi-date"></div>
                  <div id="outputRecipientName" class="loi-recipient-name"></div>
                  <div id="outputRecipientTitle" class="loi-recipient-detail"></div>
                  <div id="outputRecipientCompany" class="loi-recipient-detail"></div>
                  <div id="outputRecipientAddress" class="loi-recipient-detail"></div>
                </div>

                <div class="loi-subject">Subject: <span id="outputSubject"></span></div>

                <div class="loi-body">
                  <p>Dear <span id="outputRecipientSalutation"></span>,</p>
                  <div id="outputIntro"></div>
                  <div id="outputTerms" class="loi-terms"></div>
                  <div id="outputBinding"></div>
                  <div id="outputClosing"></div>
                  <p id="outputExpiry" class="loi-expiry"></p>
                </div>

                <section class="loi-signatures">
                  <div class="loi-signature-block">
                    <div class="signature-heading">Buyer:</div>
                    <div id="outputSenderCompanySignature"></div>
                    <div class="signature-line-group">
                      <span>By:</span>
                      <span class="signature-line signature-line--wide"></span>
                    </div>
                    <div class="loi-signature-note">(Authorized Signatory)</div>
                    <div>Name: <span id="buyerNamePrinted" class="signature-line signature-line--medium"></span></div>
                    <div>Title: <span id="buyerTitlePrinted" class="signature-line signature-line--medium"></span></div>
                    <div>Date: <span class="signature-line signature-line--short"></span></div>
                  </div>
                  <div class="loi-signature-block">
                    <div class="signature-heading">Seller:</div>
                    <div id="outputRecipientCompanySignature"></div>
                    <div class="signature-line-group">
                      <span>By:</span>
                      <span class="signature-line signature-line--wide"></span>
                    </div>
                    <div class="loi-signature-note">(Authorized Signatory)</div>
                    <div>Name: <span class="signature-line signature-line--medium"></span></div>
                    <div>Title: <span class="signature-line signature-line--medium"></span></div>
                    <div>Date: <span class="signature-line signature-line--short"></span></div>
                  </div>
                </section>
              </article>
            </div>
          </section>
        </div>
      </div>
    </section>
  </main>

  <footer class="site-footer">
    <div class="container">
      <p class="disclosure">This is not an offer to sell or a solicitation to buy any security. Any investment will be made only pursuant to definitive documents provided to qualified investors.</p>
      <div>Â© <span id="current-year"></span> <span class="footer-entity">Monthaven Capital Inc.</span></div>
      <div class="footer-links">
        <a href="/legal/terms">Terms</a>
        <a href="/legal/privacy">Privacy</a>
        <a href="/legal/accessibility">Accessibility</a>
        <a href="/legal/sms">SMS Terms</a>
      </div>
      <div class="footer-contacts">
        <a href="https://www.linkedin.com/company/monthavencapital" target="_blank" rel="noreferrer">LinkedIn</a>
        <a href="mailto:info@monthavencapital.com">info@monthavencapital.com</a>
        <a href="mailto:mandates@monthavencapital.com">mandates@monthavencapital.com</a>
      </div>
    </div>
  </footer>

  <script>
    const byId = (id) => document.getElementById(id);
    const toLocalDate = (value) => {
      if (!value) return null;
      if (value instanceof Date) return value;

      if (typeof value === 'string') {
        const isoMatch = value.match(/^(\d{4})-(\d{2})-(\d{2})$/);
        if (isoMatch) {
          const [, year, month, day] = isoMatch;
          return new Date(Number(year), Number(month) - 1, Number(day));
        }
      }

      const parsed = new Date(value);
      return Number.isNaN(parsed.getTime()) ? null : parsed;
    };

    const fmtDate = (value) => {
      const date = toLocalDate(value);
      return date
        ? date.toLocaleDateString('en-US', { year: 'numeric', month: 'long', day: 'numeric' })
        : '';
    };

    const today = new Date();
    byId('letterDate').valueAsDate = today;
    const defaultExpiry = new Date();
    defaultExpiry.setDate(defaultExpiry.getDate() + 7);
    byId('expiryDate').valueAsDate = defaultExpiry;

    const formWrapper = byId('formWrapper');
    const previewWrapper = byId('previewWrapper');
    const layout = byId('loiLayout');
    const doc = byId('loiOutput');

    const institutionalIntro = `This Letter of Intent (the "Letter") outlines the proposed terms and conditions for a transaction in which Your Company, LLC or its affiliate ("Buyer") would acquire substantially all of the assets of Recipient Corp. ("Seller").`;

    const institutionalTerms = [
      `1. The Proposed Transaction: Buyer proposes to acquire substantially all of the assets used in the operation of the Seller's business (the "Assets"). Included Assets: The Assets shall include, but not be limited to, all intellectual property, customer and supplier lists, contracts, inventory, equipment, and goodwill. Excluded Assets: The Seller will retain certain assets, such as cash, cash equivalents, and accounts receivable existing at Closing (unless otherwise agreed). Excluded Liabilities: The Buyer will not assume any of the Seller's liabilities or obligations, past or present, except for those expressly identified and agreed upon in the Definitive Agreement. The transaction will be on a "cash-free, debt-free" basis.`,
      `2. Purchase Price: The proposed purchase price is $5,000,000 USD. Payment: The Purchase Price will be payable in cash at the closing of the transaction (the "Closing"). Working Capital Adjustment: The Purchase Price will be subject to a standard post-Closing adjustment to ensure a normalized level of net working capital is delivered to the Buyer. The specific target and calculation method will be detailed in the Definitive Agreement.`,
      `3. Key Conditions: The Closing of the Proposed Transaction will be contingent upon several conditions, including: (i) the successful completion of Buyer's due diligence to its sole satisfaction; (ii) the negotiation and execution of a definitive Asset Purchase Agreement (the "Definitive Agreement"); (iii) receipt of any necessary board, shareholder, and third-party consents; (iv) the absence of any material adverse change in the Seller's business or financial condition; and (v) the retention of certain key employees identified by the Buyer.`,
      `4. Due Diligence: Upon execution of this Letter, Seller shall provide Buyer and its representatives with reasonable access to its business, financial, legal, and operational records and facilities for a period of 30 days (the "Diligence Period").`,
      `5. Definitive Agreement: The parties will negotiate in good faith to draft a Definitive Agreement that will contain standard representations, warranties, covenants, and indemnification provisions customary for a transaction of this nature.`,
      `6. Binding Provisions: This Letter is an expression of intent and is non-binding, creating no legal obligations on either party, except for the following provisions, which shall be legally binding and survive the termination of this Letter: Confidentiality: Both parties agree to keep the existence and content of these negotiations, as well as all information shared during due diligence, strictly confidential. A separate Non-Disclosure Agreement may be executed. Exclusivity (No-Shop): From the date of execution until the expiration of this Letter, Seller agrees not to, directly or indirectly, solicit, initiate, or engage in discussions with any other party regarding the sale of its business or assets. Expenses: Each party will be responsible for its own costs and expenses incurred in connection with the Proposed Transaction, including legal, accounting, and advisory fees. Governing Law: This Letter and the binding provisions shall be governed by the laws of the State of [Insert State].`,
      `7. Expiration: This offer shall expire at 5:00 p.m. Eastern Time on November 3, 2025, unless accepted by the Seller in writing, or otherwise extended by the Buyer in writing.`
    ].join('\n');

    const institutionalBinding = `This Letter is intended solely as a non-binding expression of mutual intent. Except for the provisions titled Confidentiality, Exclusivity (No-Shop), Expenses, and Governing Law (collectively, the "Binding Provisions"), neither party shall be under any legal obligation with respect to the Proposed Transaction unless and until a Definitive Agreement is executed.`;

    const institutionalClosing = `We are enthusiastic about the potential of this transaction and look forward to working with you toward a successful closing.\n\nPlease signify your agreement with the Binding Provisions and the process outlined above by signing and returning a countersigned copy of this Letter.`;

    byId('prefillBtn').addEventListener('click', () => {
      byId('introParagraph').value = institutionalIntro;
      byId('keyTerms').value = institutionalTerms;
      byId('bindingClause').value = institutionalBinding;
      byId('closingParagraph').value = institutionalClosing;
    });

    byId('logoUpload').addEventListener('change', (e) => {
      const file = e.target.files[0];
      if (!file) {
        return;
      }
      const reader = new FileReader();
      reader.onload = (ev) => {
        const img = byId('logoPreview');
        img.src = ev.target.result;
        img.classList.remove('hidden');
      };
      reader.readAsDataURL(file);
    });

    const toOrderedList = (text) => {
      if (!text) return '';
      const lines = text.split(/\n+/).filter(Boolean);
      const isNumbered = lines.every((line) => /^\s*\d+\./.test(line) || /^\s*<\/?(ol|li)/i.test(line));
      if (isNumbered) {
        const items = lines
          .map((line) => line.replace(/^\s*\d+\.\s*/, '').trim())
          .map((line) => `<li>${line}</li>`)
          .join('');
        return `<ol>${items}</ol>`;
      }
      return lines.map((line) => `<p>${line}</p>`).join('');
    };

    const escapeHTML = (str) =>
      str
        .replaceAll('&', '&amp;')
        .replaceAll('<', '&lt;')
        .replaceAll('>', '&gt;')
        .replaceAll('"', '&quot;')
        .replaceAll("'", '&#039;');

    const renderPreview = () => {
      const senderName = byId('senderName').value.trim();
      const senderTitle = byId('senderTitle').value.trim();
      const senderCompany = byId('senderCompany').value.trim();
      const senderAddress = byId('senderAddress').value.trim();
      const senderEmail = byId('senderEmail').value.trim();

      const recipientName = byId('recipientName').value.trim();
      const recipientTitle = byId('recipientTitle').value.trim();
      const recipientCompany = byId('recipientCompany').value.trim();
      const recipientAddress = byId('recipientAddress').value.trim();

      const letterDateRaw = (() => {
        const inputValue = byId('letterDate').value;
        if (inputValue) return inputValue;

        const today = new Date();
        return [
          today.getFullYear(),
          String(today.getMonth() + 1).padStart(2, '0'),
          String(today.getDate()).padStart(2, '0'),
        ].join('-');
      })();
      const expiryDateRaw = byId('expiryDate').value;
      const letterDate = fmtDate(letterDateRaw);
      const subject = byId('subject').value.trim();

      const intro = escapeHTML(byId('introParagraph').value).replace(/\n\n+/g, '</p><p>').replace(/\n/g, '<br>');
      const termsHTML = toOrderedList(byId('keyTerms').value);
      const binding = escapeHTML(byId('bindingClause').value).replace(/\n\n+/g, '</p><p>').replace(/\n/g, '<br>');
      const closing = escapeHTML(byId('closingParagraph').value).replace(/\n\n+/g, '</p><p>').replace(/\n/g, '<br>');

      byId('printHeaderLeft').textContent = senderCompany || '';
      byId('printHeaderRight').textContent = subject || '';

      byId('outputSenderCompany').textContent = senderCompany;
      byId('outputSenderAddress').textContent = senderAddress;
      byId('outputSenderEmail').textContent = senderEmail;

      byId('outputDate').textContent = letterDate;
      byId('outputRecipientName').textContent = recipientName;
      byId('outputRecipientTitle').textContent = recipientTitle;
      byId('outputRecipientCompany').textContent = recipientCompany;
      byId('outputRecipientAddress').textContent = recipientAddress;

      byId('outputSubject').textContent = subject;

      const nameParts = recipientName.split(/\s+/).filter(Boolean);
      const lastName = nameParts.length > 1 ? nameParts[nameParts.length - 1] : nameParts[0] || 'Sir/Madam';
      byId('outputRecipientSalutation').textContent = `Mr./Ms. ${lastName}`;

      byId('outputIntro').innerHTML = intro ? `<p>${intro}</p>` : '';
      byId('outputTerms').innerHTML = termsHTML;
      byId('outputBinding').innerHTML = binding ? `<p>${binding}</p>` : '';
      byId('outputClosing').innerHTML = closing ? `<p>${closing}</p>` : '';
      byId('outputExpiry').textContent = expiryDateRaw
        ? `This LOI shall expire at 5:00 p.m. Eastern Time on ${fmtDate(expiryDateRaw)} unless executed earlier or extended in writing.`
        : '';

      byId('buyerNamePrinted').textContent = senderName;
      byId('buyerTitlePrinted').textContent = senderTitle;
      byId('outputSenderCompanySignature').textContent = senderCompany;
      byId('outputRecipientCompanySignature').textContent = recipientCompany;

      doc.classList.toggle('watermark', byId('toggleWatermark').checked);
    };

    byId('loiForm').addEventListener('submit', (event) => {
      event.preventDefault();
      renderPreview();
      previewWrapper.classList.add('show-preview');
      formWrapper.classList.add('hidden');
      layout?.classList.add('with-preview');
      window.scrollTo({ top: 0, behavior: 'smooth' });
    });

    byId('copyBtn').addEventListener('click', async () => {
      const parts = [
        byId('introParagraph').value,
        byId('keyTerms').value,
        byId('bindingClause').value,
        byId('closingParagraph').value
      ]
        .filter(Boolean)
        .join('\n\n');
      try {
        await navigator.clipboard.writeText(parts);
        alert('Copied body text to clipboard.');
      } catch (error) {
        alert('Copy failed. You can still select and copy manually.');
      }
    });

    byId('printButton')?.addEventListener('click', () => window.print());

    byId('backToForm')?.addEventListener('click', () => {
      previewWrapper.classList.remove('show-preview');
      formWrapper.classList.remove('hidden');
      layout?.classList.remove('with-preview');
      window.scrollTo({ top: 0, behavior: 'smooth' });
    });

    byId('resetButton').addEventListener('click', () => {
      const form = byId('loiForm');
      form.reset();
      byId('letterDate').valueAsDate = new Date();
      const exp = new Date();
      exp.setDate(exp.getDate() + 7);
      byId('expiryDate').valueAsDate = exp;
      const img = byId('logoPreview');
      img.src = '#';
      img.classList.add('hidden');
      previewWrapper.classList.remove('show-preview');
      formWrapper.classList.remove('hidden');
      layout?.classList.remove('with-preview');
      doc.classList.remove('watermark');
    });

    byId('toggleWatermark').addEventListener('change', (event) => {
      doc.classList.toggle('watermark', event.target.checked);
    });
  </script>
  <script src="/scripts.js"></script>
</body>
</html>
